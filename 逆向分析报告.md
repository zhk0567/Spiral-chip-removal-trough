# 图源刀具绘图系统V3.16-标准版-20251023.exe 逆向分析报告

## 一、文件基本信息

- **文件名**: 图源刀具绘图系统V3.16-标准版-20251023.exe
- **文件大小**: 121,268,755 字节 (115.65 MB)
- **文件类型**: Windows PE32+ 可执行文件 (64位)
- **编译时间戳**: 1533043810 (2018-08-01 左右)

## 二、PE文件结构分析

### 2.1 基本结构

- **PE类型**: PE32+ (64位)
- **入口点**: 0x0000301C
- **基址**: 0x0000000140000000
- **机器类型**: x64 (0x8664)
- **特征标志**: 0x0022

### 2.2 PE节表

| 节名 | 虚拟地址 | 虚拟大小 | 原始大小 | 说明 |
|------|---------|---------|---------|------|
| .text | 0x00001000 | 0x000064D3 | 0x00006600 | 代码段 |
| .rdata | 0x00008000 | 0x00003A82 | 0x00003C00 | 只读数据段 |
| .data | 0x0000C000 | 0x00002200 | 0x00001000 | 数据段 |
| .pdata | 0x0000F000 | 0x000005D0 | 0x00000600 | 异常处理数据 |
| .rsrc | 0x00010000 | 0x00006E94 | 0x00007000 | 资源段 |
| .reloc | 0x00017000 | 0x000003DE | 0x00000400 | 重定位表 |

**重要发现**: 
- 所有PE节的总大小约为 28KB
- 文件实际大小为 115.65 MB
- **差异超过115MB，说明文件包含大量附加数据（overlay）**

### 2.3 导入的DLL和API

#### KERNEL32.dll
主要使用的API包括：
- 文件操作：`CreateDirectoryA`, `DeleteFileA`, `GetFileAttributesA`, `GetTempPathA`
- 内存管理：`HeapAlloc`, `HeapFree`, `HeapReAlloc`
- 进程/线程：`GetCurrentProcess`, `GetCurrentThreadId`, `ExitProcess`
- 字符串操作：`lstrcpyA`, `lstrcatA`, `lstrlenA`
- 模块操作：`LoadLibraryA/W`, `GetModuleHandleA/W`, `GetProcAddress`
- 异常处理：`UnhandledExceptionFilter`, `SetUnhandledExceptionFilter`

#### USER32.dll
- `MessageBoxA` - 消息框
- `DispatchMessageA`, `PeekMessageA`, `TranslateMessage` - 消息循环
- `LoadCursorA`, `SetCursor` - 光标操作

#### ADVAPI32.dll
- `OpenProcessToken`, `GetTokenInformation` - 权限相关

#### SHELL32.dll
- `ShellExecuteExA` - 执行外部程序

### 2.4 导出函数

**无导出函数** - 这是一个独立的可执行程序，不提供API供其他程序调用。

## 三、资源分析

### 3.1 图标资源
- **RT_ICON**: 9个图标资源（ID 1-9）
- **RT_GROUP_ICON**: 1个图标组（ID 101）
- 图标大小从296字节到9640字节不等

### 3.2 版本信息
- **RT_VERSION**: 包含版本信息（992字节）
- 版本信息已提取到 `extracted_resources/RT_VERSION/ID_1_Lang_1033.bin`

### 3.3 清单文件
- **RT_MANIFEST**: 包含应用程序清单（1429字节）
- 清单文件已提取到 `extracted_resources/RT_MANIFEST/ID_1_Lang_1033.bin`

## 四、嵌入文件分析

### 4.1 发现的文件签名

通过文件签名扫描，发现了大量嵌入的文件：

| 文件类型 | 发现数量 | 说明 |
|---------|---------|------|
| **BMP图片** | **1833个** | 大量位图图片嵌入在文件中 |
| **PE/EXE/DLL** | **1729个** | 大量可执行文件或DLL嵌入 |
| **GZIP压缩包** | **10+个** | 压缩数据 |

### 4.2 文件结构推测

基于分析结果，该exe文件的结构可能是：

```
[PE文件主体] (~28KB)
    ├── .text (代码段)
    ├── .rdata (只读数据)
    ├── .data (数据段)
    ├── .pdata (异常处理)
    ├── .rsrc (资源)
    └── .reloc (重定位)
    
[附加数据/Overlay] (~115MB)
    ├── 大量BMP图片文件
    ├── 大量PE/DLL文件
    ├── GZIP压缩数据
    └── 其他资源文件
```

### 4.3 可能的打包方式

这个exe文件很可能使用了以下技术之一：
1. **自解压安装程序** - 将安装文件打包在exe中
2. **资源嵌入** - 将大量资源文件嵌入到exe中
3. **单文件打包工具** - 使用类似NSIS、Inno Setup等工具打包
4. **虚拟文件系统** - 使用类似7-Zip SFX的方式打包

## 五、技术特征

### 5.1 编译特征
- 使用标准Windows PE格式
- 64位应用程序
- 包含异常处理信息（.pdata节）
- 包含重定位信息（.reloc节）

### 5.2 运行特征
- 需要Windows系统
- 使用标准Windows API
- 可能包含GUI界面（USER32.dll）
- 可能需要管理员权限（ADVAPI32.dll）

### 5.3 安全特征
- 包含异常处理机制
- 使用标准Windows安全API
- 未发现明显的加壳或混淆

## 六、提取的资源

所有提取的资源文件位于 `extracted_resources/` 目录：

```
extracted_resources/
├── RT_ICON/          # 图标文件
├── RT_GROUP_ICON/    # 图标组
├── RT_VERSION/       # 版本信息
└── RT_MANIFEST/      # 应用程序清单
```

## 七、建议的进一步分析

1. **解包分析**
   - 尝试使用7-Zip或其他解压工具解包
   - 分析GZIP压缩数据
   - 提取嵌入的PE文件进行分析

2. **动态分析**
   - 使用调试器（如x64dbg）进行动态分析
   - 监控文件操作和网络活动
   - 分析运行时行为

3. **资源提取**
   - 提取所有BMP图片
   - 分析嵌入的DLL文件
   - 检查是否有配置文件或数据库

4. **反编译分析**
   - 使用IDA Pro或Ghidra进行反编译
   - 分析主要功能逻辑
   - 理解程序架构

## 八、总结

这是一个**大型的打包应用程序**，主要特点：

1. ✅ **标准PE格式** - 64位Windows可执行文件
2. ✅ **大量嵌入资源** - 包含超过1800个图片文件和1700多个PE文件
3. ✅ **自包含设计** - 所有资源打包在一个文件中
4. ✅ **可能的安装程序** - 很可能是安装包或单文件应用程序

文件大小异常大的原因是包含了大量嵌入的资源文件，而不是代码本身。实际的程序代码可能只有几十KB，其余都是资源数据。

---

**分析工具**: Python + pefile库
**分析日期**: 2025年
**分析人员**: AI Assistant

